# Cocoapods-imy-bin


## ä¸€ã€æ¦‚è¦

### ç‰¹ç‚¹

 1. æ— å…¥ä¾µå¼ã€ä¸å½±å“ç°æœ‰ä¸šåŠ¡ï¼Œä¸å½±å“ç°æœ‰ä»£ç æ¡†æ¶ã€å®Œå…¨ç»¿è‰²äº§å“~ğŸ˜€
 2. è½»é‡çº§ï¼Œåªè¦é¡¹ç›®èƒ½ç¼–è¯‘é€šè¿‡å°±èƒ½ä½¿ç”¨ï¼Œæ— è§†ç»„ä»¶åŒ–ã€æ— è§†è€¦åˆ
 3. å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
 4. ç®€åŒ–äº†æµç¨‹ï¼Œæ²¡æœ‰ç¹ççš„æäº¤ä»£ç è§„èŒƒ
 
cocoapods-imy-binåŠŸèƒ½ç‚¹ï¼š

 1. ç»„ä»¶äºŒè¿›åˆ¶åŒ–ï¼Œ`æ— å…¥ä¾µå¼`æ”¯æŒç»„ä»¶äºŒè¿›åˆ¶åŒ–ï¼Œå®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚è‡´åŠ›äºè§£å†³Ciæ‰“åŒ…é€Ÿåº¦æ…¢ã€ç ”å‘ç¼–è¯‘æ…¢ç­‰ç¼–è¯‘é—®é¢˜ã€‚
 2. æœ¬åœ°é…ç½®æ–‡ä»¶ - `Podfile_local`
 3. äºŒè¿›åˆ¶æºç è°ƒè¯•`pod bin code`ï¼Œç±»ä¼¼[ç¾å›¢ iOS å·¥ç¨‹ zsource å‘½ä»¤èƒŒåçš„é‚£äº›äº‹å„¿](https://links.jianshu.com/go?to=https%3A%2F%2Ftech.meituan.com%2F2019%2F08%2F08%2Fthe-things-behind-the-ios-project-zsource-command.html)çš„æ•ˆæœã€‚
 4. å‘½ä»¤å¿«æ·é”®`pod bin imy`ï¼Œå¦‚æ¸¸æˆå¿«æ·é”®ï¼Œæ ¹æ®é…ç½®ä¼šåœ¨ç‰¹å®šç›®å½•æ‰§è¡Œç‰¹å®šå‘½ä»¤ï¼ˆå¦‚ä»»æ„ç»ˆç«¯ç›®å½•ä¸‹ï¼Œæ‰§è¡ŒæŸä¸ªç‰¹å®šç›®å½•çš„pod update --no-repo-updateå‘½ä»¤ï¼‰ï¼Œå‡å°‘å…¶ä»–ç¹çæ“ä½œã€‚æ”¯æŒä»»æ„ä¸ªå¿«æ·é”®ã€‚

cocoapods-imy-binæ’ä»¶æ‰€å…³è”çš„ç»„ä»¶äºŒè¿›åˆ¶åŒ–ç­–ç•¥ï¼š

é¢„å…ˆå°†æ‰“åŒ…æˆ `.a`  çš„ç»„ä»¶ä¿å­˜åˆ°é™æ€æœåŠ¡å™¨ä¸Šï¼Œå¹¶åœ¨ `install` æ—¶ï¼Œå»ä¸‹è½½ç»„ä»¶å¯¹åº”çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œä»¥å‡å°‘ç»„ä»¶ç¼–è¯‘æ—¶é—´ï¼Œè¾¾åˆ°åŠ å¿« App æ‰“åŒ…ã€ç»„ä»¶å‘å¸ƒç­‰æ“ä½œçš„ç›®çš„ã€‚

å…³äº æ’ä»¶å…·ä½“çš„æ¶æ„éƒ¨ç½²å®è·µå’Œæ›´è¯¦ç»†çš„èµ„æºï¼Œå¯ä»¥å‚è€ƒ

> [iOSç¼–è¯‘é€Ÿåº¦å¦‚ä½•ç¨³å®šæé«˜10å€ä»¥ä¸Š](https://www.jianshu.com/p/08cffdfa2885)
>
> [iOSç¾å›¢åŒæ¬¾"ZSource"äºŒè¿›åˆ¶è°ƒè¯•å®ç°](https://juejin.im/post/5f066cfa5188252e893a136e)
>
> [Demo](https://github.com/su350380433/cocoapods-imy-bin-demo)
>


## äºŒã€å‡†å¤‡å·¥ä½œ



### 1ã€å®‰è£…æ’ä»¶

```shell
sudo gem install cocoapods-imy-bin
```



## ä¸‰ã€ä½¿ç”¨äºŒè¿›åˆ¶ç»„ä»¶


### 1ã€ç¯å¢ƒæ­å»º

<br/>

[ç¯å¢ƒæ­å»ºè¯¦ç»†æ•™ç¨‹](https://github.com/su350380433/cocoapods-imy-bin-demo)

ä½¿ç”¨äºŒè¿›åˆ¶æ—¶ï¼Œæœ¬æ’ä»¶éœ€è¦æä¾›ä»¥ä¸‹èµ„æºï¼š

- é™æ€èµ„æºæœåŠ¡å™¨ï¼ˆ [binary-server](https://github.com/su350380433/binary-server)ï¼Œé™„è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ï¼‰
- äºŒè¿›åˆ¶ç§æœ‰æºä»“åº“ï¼ˆä¿å­˜ç»„ä»¶äºŒè¿›åˆ¶ç‰ˆæœ¬ podspecï¼‰



### 2ã€åˆå§‹åŒ–æ’ä»¶

``` shell
xx:Demo slj$ pod bin init

======  dev ç¯å¢ƒ ========

å¼€å§‹è®¾ç½®äºŒè¿›åˆ¶åŒ–åˆå§‹ä¿¡æ¯.
æ‰€æœ‰çš„ä¿¡æ¯éƒ½ä¼šä¿å­˜åœ¨ /Users/slj/.cocoapods/bin_dev.yml æ–‡ä»¶ä¸­.
%w[bin_dev.yml bin_debug_iphoneos.yml bin_release_iphoneos.yml] 
ä½ å¯ä»¥åœ¨å¯¹åº”ç›®å½•ä¸‹æ‰‹åŠ¨æ·»åŠ ç¼–è¾‘è¯¥æ–‡ä»¶. æ–‡ä»¶åŒ…å«çš„é…ç½®ä¿¡æ¯æ ·å¼å¦‚ä¸‹ï¼š

---
configuration_env: dev
code_repo_url: git@github.com:su350380433/example_spec_source.git
binary_repo_url: git@github.com:su350380433/example_spec_bin_dev.git
binary_download_url: http://localhost:8080/frameworks/%s/%s/zip
download_file_type: zip


ç¼–è¯‘ç¯å¢ƒ
å¯é€‰å€¼ï¼š[ dev / debug_iphoneos / release_iphoneos ]
æ—§å€¼ï¼šdev
```

æŒ‰æç¤ºè¾“å…¥`æ‰€å±ç¯å¢ƒ`ã€æºç ç§æœ‰æºã€äºŒè¿›åˆ¶ç§æœ‰æºã€äºŒè¿›åˆ¶ä¸‹è½½åœ°å€ã€ä¸‹è½½æ–‡ä»¶ç±»å‹åï¼Œæ’ä»¶å°±é…ç½®å®Œæˆäº†ã€‚å…¶ä¸­ `binary_download_url` éœ€è¦é¢„ç•™ç»„ä»¶åç§°ä¸ç»„ä»¶ç‰ˆæœ¬å ä½ç¬¦ï¼Œæ’ä»¶å†…éƒ¨ä¼šä¾æ¬¡æ›¿æ¢ `%s` ä¸ºç›¸åº”ç»„ä»¶çš„å€¼ã€‚

`cococapods-imy-bin` ä¹Ÿæ”¯æŒä» url ä¸‹è½½é…ç½®æ–‡ä»¶ï¼Œæ–¹ä¾¿å¯¹å¤šå°æœºå™¨è¿›è¡Œé…ç½®ï¼š

```shell
âœ  ~ pod bin init --bin-url=https://github.com/su350380433/cocoapods-imy-bin-configs/raw/master/bin_dev.yml
```

é…ç½®æ–‡ä»¶æ¨¡ç‰ˆå†…å®¹å¦‚ä¸‹ï¼Œæ ¹æ®ä¸åŒå›¢é˜Ÿçš„éœ€æ±‚å®šåˆ¶å³å¯ï¼š

```shell
---
configuration_env: dev
code_repo_url: git@github.com:su350380433/example_spec_source.git
binary_repo_url: git@github.com:su350380433/example_spec_bin_dev.git
binary_download_url: http://localhost:8080/frameworks/%s/%s/zip
download_file_type: zip

```

é…ç½®æ—¶ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ·»åŠ æºç å’ŒäºŒè¿›åˆ¶ç§æœ‰æºçš„ repoï¼Œæ’ä»¶åœ¨æ‰¾ä¸åˆ°å¯¹åº” repo æ—¶ä¼šä¸»åŠ¨ cloneã€‚

è®°å¾—å¯åŠ¨ `sudo mongod`æœåŠ¡ï¼Œé™æ€èµ„æºæœåŠ¡ã€‚


<br/>

## å››ã€åˆ¶ä½œäºŒè¿›åˆ¶ç»„ä»¶

<br/>

[è§†é¢‘æ¼”ç¤º](https://github.com/MeetYouDevs/cocoapods-imy-bin/tree/master/%E6%BC%94%E7%A4%BA%E8%A7%86%E9%A2%91)

### 1ã€åˆ¶ä½œå‘½ä»¤

å¯ä»¥ç›´æ¥ä½¿ç”¨æ’ä»¶çš„ `pod bin auto`å‘½ä»¤ï¼Œåœ¨æ’ä»¶åˆå§‹åŒ–é…ç½®å®Œæˆåï¼Œç›®å½•ä¸‹åªè¦æœ‰åŒ…å«podspecæ–‡ä»¶ï¼Œæ ¹æ®podspecæ–‡ä»¶çš„versionç‰ˆæœ¬å·ä¼šè‡ªåŠ¨åŒ–æ‰§è¡Œbuildã€ç»„è£…äºŒè¿›åˆ¶ç»„ä»¶ã€åˆ¶ä½œäºŒè¿›åˆ¶podspecã€ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶ã€ä¸Šä¼ äºŒè¿›åˆ¶podspecåˆ°ç§æœ‰æºä»“åº“ã€‚

```shell
pod bin auto
```

å¸¦ä¸Š`â€”all-make`å‚æ•°ä¼šæŠŠå½“å‰ç»„ä»¶æ‰€ä¾èµ–çš„ç»„ä»¶éƒ½è‡ªåŠ¨åŒ–åˆ¶ä½œæˆäºŒè¿›åˆ¶ç»„ä»¶ã€‚

```shell
pod bin local
```

pod bin local æ˜¯é…åˆå…¶ä»–ä¸‰æ–¹ç¼–è¯‘äº§ç‰©çš„å‘½ä»¤ï¼Œéœ€è¦é…ç½®ç¼–è¯‘äº§ç‰©çš„ç›®å½•ã€‚

`BinArchive.json`æ˜¯åˆ¶ä½œäºŒè¿›åˆ¶çš„ä¸€äº›é…ç½®é¡¹ï¼Œæ”¾åœ¨é¡¹ç›®è·Ÿç›®å½•ä¸‹ï¼š

``` json
{
    "//": "archive-white-pod-list ä¸åˆ¶ä½œäºŒè¿›åˆ¶ç™½åå•ï¼Œ",
    "archive-white-pod-list" : [
        "YYTargetDemo",
        "YYModel"
    ],
    "//": "ignore-git-list ä¸åˆ¶ä½œäºŒè¿›åˆ¶ æ‰€å±gitç™½åå•ï¼Œ",
    "ignore-git-list": [
        "git@gitlab.xxx.com:Github-iOS"
    ],
     "//": "ignore-http-list ä¸åˆ¶ä½œäºŒè¿›åˆ¶ æ‰€å±httpsç™½åå•ï¼Œ",
    "ignore-http-list": [
        "https://gitlab.xxx.com/Github-iOS"
    ],
    "//": "xcode_build_path è®¾ç½®ç¼–è¯‘ç¼“å­˜å®Œæ•´è·¯å¾„, é»˜è®¤åœ°å€å¦‚ä¸‹",
    "xcode_build_path" : "xcode-build/Build/Intermediates.noindex/ArchiveIntermediates/#{target_name}/IntermediateBuildFilesPath/UninstalledProducts/iphoneos/",
}
```


<br/>

### 2. äºŒè¿›åˆ¶Podspec 

é€šè¿‡`pod bin auto`å’Œ`pod bin local`äºŒè¿›åˆ¶Podspec ä¼šè‡ªåŠ¨ç”Ÿæˆã€ä¸Šä¼ ï¼Œæ— éœ€å…³å¿ƒã€‚


<br/>

### 3ã€æŸ¥çœ‹ç»“æœ

äºŒè¿›åˆ¶å­˜å‚¨æœåŠ¡ï¼š[http://localhost:8080/frameworks/](http://localhost:8080/frameworks/)ï¼ˆé»˜è®¤æœ¬åœ°8080ç«¯å£ï¼‰

äºŒè¿›åˆ¶ç§æœ‰æºå‚è€ƒï¼š[https://github.com/su350380433/example_spec_bin_dev](https://github.com/su350380433/example_spec_bin_dev)ï¼ˆè‡ªå®šä¹‰ï¼‰


<br/>

### 4ã€ä½¿ç”¨äºŒè¿›åˆ¶

<br/>

[è§†é¢‘æ¼”ç¤º](https://github.com/MeetYouDevs/cocoapods-imy-bin/tree/master/%E6%BC%94%E7%A4%BA%E8%A7%86%E9%A2%91)

åœ¨Podfileæ–‡ä»¶ä¸­ï¼ŒåŠ å…¥è¿™ä¸¤è¡Œä»£ç ï¼Œå¯¹å·²ç»åˆ¶ä½œäºŒè¿›åˆ¶çš„å°±ä¼šç”Ÿæ•ˆï¼Œè‡ªåŠ¨è½¬æ¢äºŒè¿›åˆ¶ç»„ä»¶ä¾èµ–ã€‚

``` ruby
plugin 'cocoapods-imy-bin'
use_binaries!
```


<br/>

## äº”ã€æ‰©å±•åŠŸèƒ½

<br/>

### 1ã€æœ¬åœ°é…ç½®æ–‡ä»¶ - Podfile_local

æœ¬åœ°ç»„ä»¶é…ç½®æ–‡ä»¶ Podfile_localï¼Œç›®å‰å·²æ”¯æŒPodfileä¸‹çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œå¯ä»¥æŠŠä¸€äº›æœ¬åœ°é…ç½®çš„è¯­å¥æ”¾åˆ°Podfile_localã€‚

<img src="https://raw.githubusercontent.com/MeetYouDevs/cocoapods-imy-bin/master/img/Podfile_local.png" style="zoom:50%;" />

åœºæ™¯: 

1. ä¸å¸Œæœ›æŠŠæœ¬åœ°é‡‡ç”¨çš„æºç /äºŒè¿›åˆ¶é…ç½®ã€æœ¬åœ°åº“ä¼ åˆ°è¿œç¨‹ä»“åº“ã€‚
2. é¿å…ç›´æ¥ä¿®æ”¹Podfileæ–‡ä»¶ï¼Œå¼•èµ·æ›´æ–°ä»£ç æ—¶å†²çªã€æˆ–è€…è¯¯æäº¤ã€‚

å¦‚Podfileæœ¬åœ°åº“çš„å†™æ³•ï¼š
```ruby
pod YYModel :path => '../' #æäº¤çš„æ—¶å€™å¾€å¾€è¦ä¿®æ”¹å›æ¥æ‰æäº¤ï¼Œæ“ä½œç¹ç
```
ç”¨æ³•ï¼š

åœ¨ä¸PodfileåŒçº§ç›®å½•ä¸‹ï¼Œæ–°å¢ä¸€ä¸ª`Podfile_local`æ–‡ä»¶

```ruby
#target 'Seeyou' do ä¸åŒçš„é¡¹ç›®æ³¨æ„ä¿®æ”¹ä¸‹Seeyouçš„å€¼
#:path => '../IMYYQHome',æ ¹æ®å®é™…æƒ…å†µè‡ªè¡Œä¿®æ”¹ï¼Œä¸ä¹‹å‰åœ¨podfileå†™æ³•ä¸€è‡´


 plugin 'cocoapods-imy-bin'
#æ˜¯å¦å¯ç”¨äºŒè¿›åˆ¶æ’ä»¶ï¼Œæƒ³å¼€å¯æŠŠä¸‹é¢æ³¨é‡Šå»æ‰
# use_binaries! 

#è®¾ç½®ä½¿ç”¨ã€æºç ã€‘ç‰ˆæœ¬çš„ç»„ä»¶ã€‚
#set_use_source_pods ['YYKit','SDWebImaage']

#éœ€è¦æ›¿æ¢Podfileé‡Œé¢çš„ç»„ä»¶æ‰å†™åˆ°è¿™é‡Œ
#åœ¨è¿™é‡Œé¢çš„æ‰€å†™çš„ç»„ä»¶åº“ä¾èµ–ï¼Œé»˜è®¤åˆ‡æ¢ä¸ºã€æºç ã€‘ä¾èµ–
target 'Seeyou' do
  #æœ¬åœ°åº“å¼•ç”¨
	#pod 'YYModel', :path => '../YYModel'

  #è¦†ç›–ã€è‡ªå®šä¹‰ç»„ä»¶
  	#pod 'YYCache', :podspec => 'http://è¦†ç›–ã€è‡ªå®šä¹‰/'
end
```

```ruby
ä»¥å‰çš„ pod update --no-repo-update å‘½ä»¤åŠ ä¸ªå‰ç¼€ `bin` å˜æˆ
```

```shell
pod bin update --no-repo-update 
```
or
```shell
pod bin install
```

æ”¯æŒ pod install/update å‘½ä»¤å‚æ•°

å¹¶å°†å…¶åŠ å…¥ .gitignore ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘è¯¯æäº¤æˆ–è€…å†²çªäº†ï¼ŒPodfile_local ä¸­çš„é…ç½®é€‰é¡¹ä¼˜å…ˆçº§æ¯” Podfile é«˜ï¼Œæ”¯æŒå’Œ Podfile ç›¸åŒçš„é…ç½®è¯­å¥ï¼ŒåŒæ—¶æ”¯æŒ**pre_install** or **post_install**ã€‚


å¦‚æœæ‚¨ä¸ä¹ æƒ¯Podfile_localçš„ä½¿ç”¨æ–¹å¼ï¼Œå¯ä»¥æŠŠå‘½ä»¤å†™åœ¨Podfileé‡Œé¢ï¼Œpodæ—¶ä¸éœ€è¦åŠ binï¼Œä¾æ—§æ˜¯ pod update/installã€‚


<br/>

### 2ã€äºŒè¿›åˆ¶æºç è°ƒè¯•

<br/>

[è§†é¢‘æ¼”ç¤º](https://github.com/MeetYouDevs/cocoapods-imy-bin/tree/master/%E6%BC%94%E7%A4%BA%E8%A7%86%E9%A2%91)

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¾“å…¥å‘½ä»¤:

```ruby
pod bin code YYModel
```

`YYModel`ä¸ºéœ€è¦æºç è°ƒè¯•çš„ç»„ä»¶åº“åç§°ã€‚æˆåŠŸä¹‹ååƒå¹³æ—¶ä¸€æ ·å•æ­¥è°ƒè¯•ï¼Œæ§åˆ¶å°æ‰“å°å˜é‡ã€‚è®©æˆ‘ä»¬åŒæ—¶æ‹¥æœ‰ä½¿ç”¨äºŒè¿›åˆ¶çš„ä¾¿åˆ©å’Œæºç è°ƒè¯•çš„èƒ½åŠ›ã€‚

``` shell
 $ pod bin code --help                                                                   [11:37:50]
Usage:

    $ pod bin code [NAME]

      é€šè¿‡å°†äºŒè¿›åˆ¶å¯¹åº”æºç æ”¾ç½®åœ¨ä¸´æ—¶ç›®å½•ä¸­ï¼Œè®©äºŒè¿›åˆ¶å‡ºç°æ–­ç‚¹æ—¶å¯ä»¥è·³åˆ°å¯¹åº”çš„æºç ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚ åœ¨ä¸åˆ é™¤äºŒè¿›åˆ¶çš„æƒ…å†µä¸‹ä¸ºæŸä¸ªç»„ä»¶æ·»åŠ æºç è°ƒè¯•èƒ½åŠ›ï¼Œå¤šä¸ªç»„ä»¶åç§°ç”¨ç©ºæ ¼åˆ†éš”

Options:

    --all-clean   åˆ é™¤æ‰€æœ‰å·²ç»ä¸‹è½½çš„æºç 
    --clean       åˆ é™¤æ‰€æœ‰æŒ‡å®šä¸‹è½½çš„æºç 
    --list        å±•ç¤ºæ‰€æœ‰ä¸€çº§ä¸‹è½½çš„æºç ä»¥åŠå…¶å¤§å°
    --source      æºç è·¯å¾„ï¼Œæœ¬åœ°è·¯å¾„,ä¼šå»è‡ªåŠ¨é“¾æ¥æœ¬åœ°æºç 
```

æ•ˆæœä¸æ¼”ç¤ºå‚è€ƒ[é“¾æ¥1](https://juejin.im/post/5eccceb9f265da76f30e4e13#heading-48)ã€[è§†é¢‘](https://github.com/MeetYouDevs/cocoapods-imy-bin/tree/master/%E6%BC%94%E7%A4%BA%E8%A7%86%E9%A2%91)


<br/>

### 3ã€å¿«æ·é”®å‘½ä»¤

<br/>

åœ¨ä»»æ„çš„ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼Œéƒ½èƒ½æ‰§è¡Œç‰¹å®šç›®å½•ä¸‹ç‰¹å®šå‘½ä»¤

ä½¿ç”¨å‘½ä»¤ï¼š

```shell
pod bin imy
```

or

``` shell
pod bin imy 2    #2 æ˜¯è‡ªå®šä¹‰çš„å¿«æ·é”®
```

ä½¿ç”¨åœºæ™¯:

 	1. åœ¨ä»»æ„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œé¡¹ç›®Açš„pod update --no-repo-updateå‘½ä»¤

å‘½ä»¤å¿«æ·é”®é…ç½®

```shell
 $ pod bin inithk                                                                        [11:37:58]

å¼€å§‹è®¾ç½®å¿«æ·é”® pod bin imy.
æ‰€æœ‰çš„ä¿¡æ¯éƒ½ä¼šä¿å­˜åœ¨ /Users/ci/.cocoapods/hot_key_1.yml æ–‡ä»¶ä¸­.
%w[hot_key.yaml] 
ä½ å¯ä»¥åœ¨å¯¹åº”ç›®å½•ä¸‹æ‰‹åŠ¨æ·»åŠ ç¼–è¾‘è¯¥æ–‡ä»¶. æ–‡ä»¶åŒ…å«çš„é…ç½®ä¿¡æ¯æ ·å¼å¦‚ä¸‹ï¼š

---
hot_key_index: '1'
hot_key_dir: '/User/ci/è‡ªå®šä¹‰ç›®å½•'
hot_key_cmd: pod bin update --no-repo-update


å¿«æ·é”®
å¯é€‰å€¼ï¼š[ 1 / 2 / 3... ]
æ—§å€¼ï¼š1 
```


<br/>

## å…­ã€ DSLå‚æ•°è§£é‡Š



é¦–å…ˆï¼Œå¼€å‘è€…éœ€è¦åœ¨ Podfile ä¸­éœ€è¦ä½¿ç”¨ `plugin 'cocoapods-imy-bin'` è¯­å¥å¼•å…¥æ’ä»¶ 

```ruby
plugin 'cocoapods-imy-bin'
```

é¡ºå¸¦å¯ä»¥åˆ é™¤ Podfile ä¸­çš„ source ï¼Œå› ä¸ºæ’ä»¶å†…éƒ¨ä¼šè‡ªåŠ¨å¸®ä½ æ·»åŠ ä¸¤ä¸ªç§æœ‰æºã€‚

`cocoapods-bin `æ’ä»¶æä¾›äºŒè¿›åˆ¶ç›¸å…³çš„é…ç½®è¯­å¥æœ‰ `use_binaries!`ã€`use_binaries_with_spec_selector!` ä»¥åŠ `set_use_source_pods`ï¼Œä¸‹é¢ä¼šåˆ†åˆ«ä»‹ç»ã€‚

##### use_binaries!

å…¨éƒ¨ç»„ä»¶ä½¿ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚

æ”¯æŒä¼ å…¥å¸ƒå°”å€¼æ§åˆ¶æ˜¯å¦ä½¿ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œæ¯”å¦‚ DEBUG åŒ…ä½¿ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œæ­£å¼åŒ…ä½¿ç”¨æºç ç‰ˆæœ¬ï¼ŒPodfile å…³è”è¯­å¥å¯ä»¥è¿™æ ·å†™ï¼š

```ruby
use_binaries! (ENV['DEBUG'].nil? || ENV['DEBUG'] == 'true')
```

##### set_use_source_pods

è®¾ç½®ä½¿ç”¨æºç ç‰ˆæœ¬çš„ç»„ä»¶ã€‚

å®é™…å¼€å‘ä¸­ï¼Œå¯èƒ½éœ€è¦æŸ¥çœ‹ YYModel ç»„ä»¶çš„æºç ï¼Œè¿™æ—¶å€™å¯ä»¥è¿™ä¹ˆè®¾ç½®ï¼š

```ruby
set_use_source_pods ['YYModel']
```

å¦‚æœ CocoaPods ç‰ˆæœ¬ä¸º 1.5.3 ï¼Œç»ˆç«¯ä¼šè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œè¡¨ç¤º YYModel çš„å‚ç…§æºä»äºŒè¿›åˆ¶ç§æœ‰æºåˆ‡æ¢åˆ°äº†æºç ç§æœ‰æºï¼š

```ruby
Analyzing dependencies
Fetching podspec for `A` from `../`
Downloading dependencies
Using A (0.1.0)
Installing YYModel 1.0.4.2 (source changed to `git@git.xxxxxx.net:ios/cocoapods-spec.git` from `git@git.xxxxxx.net:ios/cocoapods-spec-binary.git`)
Generating Pods project
Integrating client project
Sending stats
Pod installation complete! There is 1 dependency from the Podfile and 2 total pods installed.
```

##### use_binaries_with_spec_selector!

è¿‡æ»¤å‡ºéœ€è¦ä½¿ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬ç»„ä»¶ã€‚

å‡å¦‚å¼€å‘è€…åªéœ€è¦ `YYModel` çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œé‚£ä¹ˆä»–å¯ä»¥åœ¨ Podfile ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```ruby
use_binaries_with_spec_selector! do |spec|
  spec.name == 'YYModel'
end
```

**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç»„ä»¶æœ‰ subspec ï¼Œä½¿ç”¨ç»„ä»¶åä½œä¸ºåˆ¤æ–­æ¡ä»¶åº”å¦‚ä¸‹**ï¼š

```ruby
use_binaries_with_spec_selector! do |spec|
  spec.name.start_with? == 'ç»„ä»¶å'
end
```

å¦‚æœåƒä¸Šä¸ªä»£ç å—ä¸€æ ·ï¼Œ**ç›´æ¥å¯¹æ¯”ç»„ä»¶åï¼Œåˆ™æ’ä»¶ä¼šå¿½ç•¥æ­¤ç»„ä»¶çš„æ‰€æœ‰ subspecï¼Œå¯¼è‡´èµ„æºæ‹‰å–é”™è¯¯**ï¼Œè¿™ç§åœºæ™¯ä¸‹ï¼Œæœ€å¥½é€šè¿‡ `set_use_source_pods` è¯­å¥é…ç½®ä¾èµ–ã€‚

ä¸€ä¸ªå®é™…åº”ç”¨æ˜¯ï¼Œä¸‰æ–¹ç»„ä»¶é‡‡ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œå›¢é˜Ÿç¼–å†™çš„ç»„ä»¶ä¾æ—§é‡‡ç”¨æºç ç‰ˆæœ¬ã€‚å¦‚æœä¸‰æ–¹ç»„ä»¶éƒ½åœ¨ `cocoapods-repo` ç»„ä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿‡æ»¤å‡ºä¸‰æ–¹ç»„ä»¶ï¼š

```ruby
use_binaries_with_spec_selector! do |spec|
 git = spec.source && spec.source['git']
 git && git.include?('cocoapods-repo')
end
```

##### åˆ‡æ¢Dev/Debug_iPhoneos/Release_iPhoneosç¯å¢ƒåˆå§‹åŒ–è®¾ç½®


```shell
#dev åˆå§‹åŒ–æ’ä»¶é…ç½® é»˜è®¤devç¯å¢ƒ
pod bin init --bin-url=https://gitlab.xxx.com/cocoapods-imy-bin-config/raw/master/bin_dev.yml

#Debug_iPhoneos åˆå§‹åŒ–æ’ä»¶é…ç½®
pod bin init --bin-url=https://gitlab.xxx.com/cocoapods-imy-bin-config/raw/master/bin_debug_iphoneos.yml


#release_iPhoneos åˆå§‹åŒ–æ’ä»¶é…ç½®
pod bin init --bin-url=https://gitlab.xxx.com/cocoapods-imy-bin-config/raw/master/bin_release_iphoneos.yml
```

ä½¿ç”¨æ—¶åœ¨podfile æˆ–è€… podfile_localæŒ‡å®šè®¾ç½®

```shell
#åœ¨podfile æˆ–è€… podfile_local æ–‡ä»¶ä¸‹åŠ è¿™å¥è¯
set_configuration_env('debug_iphoneos')	
```

##### å…¶ä»–è®¾ç½®

æ’ä»¶é»˜è®¤å¼€å¯å¤šçº¿ç¨‹ä¸‹è½½ç»„ä»¶èµ„æºï¼Œå¦‚æœè¦ç¦ç”¨è¿™ä¸ªåŠŸèƒ½ï¼ŒPodfile æ·»åŠ ä»¥ä¸‹ä»£ç å³å¯ï¼š

```ruby
install! 'cocoapods', { install_with_multi_threads: false }
```


<br/>

## ä¸ƒã€æ„Ÿè°¢



**[cocoapods-bin](https://github.com/tripleCC/cocoapods-bin)**

[ç¾å›¢ iOS å·¥ç¨‹ zsource å‘½ä»¤èƒŒåçš„é‚£äº›äº‹å„¿](https://links.jianshu.com/go?to=https%3A%2F%2Ftech.meituan.com%2F2019%2F08%2F08%2Fthe-things-behind-the-ios-project-zsource-command.html)

#### æ‚¨æœ‰ä»€ä¹ˆæ›´å¥½çš„æƒ³æ³•ï¼Œå¯ä»¥æå‡ºæ¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®ç°ï¼Œå…±åˆ›ä¸€ä¸ªå¼ºå¤§çš„å¹³å°ï¼ŒåŒæ—¶ä¹Ÿæ¬¢è¿ç»™æˆ‘ä»¬æPRã€‚ 
